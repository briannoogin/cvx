Task: Predict sound of airflow in decibals given 1. Frequency, in Hertzs. 2. Angle of attack, in degrees. 3. Chord length, in meters. 4. Free-stream velocity, in meters per second. 5. Suction side displacement thickness, in meters.

Train both cvx fit and single layer neural network on same batch of data, and test on same batch of data

nn test MSE: 58.047153609816476
cvx fit test MSE: 910.8582108333107

================================================== Neural Network output log ===========================
np seed:  860
tf seed:  2405
Data snippit...
800           1000.000000
0                0.000000
0.3048           0.304800
71.3            71.300000
0.00266337       0.002663
126.201        125.201000
Name: 0, dtype: float64
/mnt/c/Users/sidda/Documents/Programming/tf_env/lib/python3.5/site-packages/sklearn/preprocessing/data.py:181: UserWarning: Numerical issues were encountered when scaling the data and might not be solved. The standard deviation of the data is probably very close to 0. 
  warnings.warn("Numerical issues were encountered "
WARNING:tensorflow:From /mnt/c/Users/sidda/Documents/Programming/tf_env/lib/python3.5/site-packages/tensorflow/python/util/tf_should_use.py:118: initialize_all_variables (from tensorflow.python.ops.variables) is deprecated and will be removed after 2017-03-02.
Instructions for updating:
Use `tf.global_variables_initializer` instead.
2018-08-05 12:25:06.778258: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
Iter: 0 Train mse: 14857.6484375
Iter: 100 Train mse: 81.38212585449219
Iter: 200 Train mse: 32.635066986083984
Iter: 300 Train mse: 20.075145721435547
Iter: 400 Train mse: 32.79008102416992
Iter: 500 Train mse: 23.279491424560547
Iter: 600 Train mse: 16.40097427368164
Iter: 700 Train mse: 15.63027572631836
Iter: 800 Train mse: 13.20730972290039
Iter: 900 Train mse: 13.147814750671387
Iter: 1000 Train mse: 13.589736938476562
Iter: 1100 Train mse: 10.85799503326416
Iter: 1200 Train mse: 12.730365753173828
Iter: 1300 Train mse: 10.629884719848633
Iter: 1400 Train mse: 15.579439163208008
Iter: 1500 Train mse: 13.342208862304688
Iter: 1600 Train mse: 9.904773712158203
Iter: 1700 Train mse: 10.868890762329102
Iter: 1800 Train mse: 6.959555625915527
Iter: 1900 Train mse: 7.964504241943359
Iter: 2000 Train mse: 7.074280738830566
Iter: 2100 Train mse: 14.20606803894043
Iter: 2200 Train mse: 9.0858793258667
Iter: 2300 Train mse: 5.592991828918457
Iter: 2400 Train mse: 8.053661346435547
Iter: 2500 Train mse: 8.77251148223877
Iter: 2600 Train mse: 8.6395263671875
Iter: 2700 Train mse: 9.735570907592773
Iter: 2800 Train mse: 6.916890621185303
Iter: 2900 Train mse: 6.666225910186768
Iter: 3000 Train mse: 24.869354248046875
Iter: 3100 Train mse: 11.279845237731934
Iter: 3200 Train mse: 9.403484344482422
Iter: 3300 Train mse: 7.400557518005371
Iter: 3400 Train mse: 10.705953598022461
Iter: 3500 Train mse: 7.294701099395752
Iter: 3600 Train mse: 6.607460021972656
Iter: 3700 Train mse: 5.7296624183654785
Iter: 3800 Train mse: 7.43023681640625
Iter: 3900 Train mse: 7.9618821144104
Iter: 4000 Train mse: 3.8390607833862305
Iter: 4100 Train mse: 6.979181289672852
Iter: 4200 Train mse: 8.406847953796387
Iter: 4300 Train mse: 5.059924602508545
Iter: 4400 Train mse: 8.137495040893555
Iter: 4500 Train mse: 10.393438339233398
Iter: 4600 Train mse: 12.613912582397461
Iter: 4700 Train mse: 5.501802444458008
Iter: 4800 Train mse: 10.7491455078125
Iter: 4900 Train mse: 8.439746856689453
Iter: 5000 Train mse: 6.658307075500488
Iter: 5100 Train mse: 5.789667129516602
Iter: 5200 Train mse: 7.7459588050842285
Iter: 5300 Train mse: 9.503765106201172
Iter: 5400 Train mse: 6.776124954223633
Iter: 5500 Train mse: 12.00735855102539
Iter: 5600 Train mse: 5.678473472595215
Iter: 5700 Train mse: 7.576188564300537
Iter: 5800 Train mse: 7.545656204223633
Iter: 5900 Train mse: 6.842426300048828
Iter: 6000 Train mse: 10.775203704833984
Iter: 6100 Train mse: 5.519034385681152
Iter: 6200 Train mse: 6.922030925750732
Iter: 6300 Train mse: 5.995916366577148
Iter: 6400 Train mse: 6.870258331298828
Iter: 6500 Train mse: 6.861609935760498
Iter: 6600 Train mse: 6.622137546539307
Iter: 6700 Train mse: 9.064149856567383
Iter: 6800 Train mse: 8.582353591918945
Iter: 6900 Train mse: 5.577542304992676
Iter: 7000 Train mse: 7.31452751159668
Iter: 7100 Train mse: 13.967296600341797
Iter: 7200 Train mse: 12.00629997253418
Iter: 7300 Train mse: 9.310932159423828
Iter: 7400 Train mse: 5.595870018005371
Iter: 7500 Train mse: 8.18071460723877
Iter: 7600 Train mse: 6.255331039428711
Iter: 7700 Train mse: 10.269984245300293
Iter: 7800 Train mse: 7.0384674072265625
Iter: 7900 Train mse: 6.042430877685547
Iter: 8000 Train mse: 6.398780822753906
Iter: 8100 Train mse: 5.986353874206543
Iter: 8200 Train mse: 5.450516700744629
Iter: 8300 Train mse: 5.796319007873535
Iter: 8400 Train mse: 6.875703811645508
Iter: 8500 Train mse: 8.06431770324707
Iter: 8600 Train mse: 11.609857559204102
Iter: 8700 Train mse: 8.233684539794922
Iter: 8800 Train mse: 6.8629350662231445
Iter: 8900 Train mse: 6.362981796264648
Iter: 9000 Train mse: 5.337696552276611
Iter: 9100 Train mse: 4.839779853820801
Iter: 9200 Train mse: 7.007245063781738
Iter: 9300 Train mse: 5.498440265655518
Iter: 9400 Train mse: 6.283906936645508
Iter: 9500 Train mse: 6.636155128479004
Iter: 9600 Train mse: 11.290960311889648
Iter: 9700 Train mse: 9.21511459350586
Iter: 9800 Train mse: 7.6847734451293945
Iter: 9900 Train mse: 8.130780220031738
Iter: 10000 Train mse: 6.8057355880737305
Iter: 10100 Train mse: 4.443151950836182
Iter: 10200 Train mse: 9.471909523010254
Iter: 10300 Train mse: 5.949084281921387
Iter: 10400 Train mse: 6.966550827026367
Iter: 10500 Train mse: 5.051779747009277
Iter: 10600 Train mse: 6.053646087646484
Iter: 10700 Train mse: 9.071100234985352
Iter: 10800 Train mse: 3.6161043643951416
Iter: 10900 Train mse: 6.238521099090576
Iter: 11000 Train mse: 8.361783981323242
Iter: 11100 Train mse: 6.471857070922852
Iter: 11200 Train mse: 8.564584732055664
Iter: 11300 Train mse: 6.631977081298828
Iter: 11400 Train mse: 11.699241638183594
Iter: 11500 Train mse: 8.796859741210938
Iter: 11600 Train mse: 6.4422383308410645
Iter: 11700 Train mse: 3.954437017440796
Iter: 11800 Train mse: 10.092611312866211
Iter: 11900 Train mse: 5.2738142013549805
Iter: 12000 Train mse: 7.088843822479248
Iter: 12100 Train mse: 8.879488945007324
Iter: 12200 Train mse: 9.219022750854492
Iter: 12300 Train mse: 5.3672075271606445
Iter: 12400 Train mse: 9.166952133178711
Iter: 12500 Train mse: 7.233368873596191
Iter: 12600 Train mse: 8.147363662719727
Iter: 12700 Train mse: 6.998883247375488
Iter: 12800 Train mse: 4.3579301834106445
Iter: 12900 Train mse: 9.060940742492676
Iter: 13000 Train mse: 6.042043209075928
Iter: 13100 Train mse: 5.07225227355957
Iter: 13200 Train mse: 8.665336608886719
Iter: 13300 Train mse: 7.986405372619629
Iter: 13400 Train mse: 7.3061933517456055
Iter: 13500 Train mse: 4.447369575500488
Iter: 13600 Train mse: 6.484963893890381
Iter: 13700 Train mse: 4.711802005767822
Iter: 13800 Train mse: 6.529751777648926
Iter: 13900 Train mse: 4.266672134399414
Iter: 14000 Train mse: 4.774299621582031
Iter: 14100 Train mse: 6.009378433227539
Iter: 14200 Train mse: 5.450112342834473
Iter: 14300 Train mse: 4.73399543762207
Iter: 14400 Train mse: 6.954919815063477
Iter: 14500 Train mse: 8.285587310791016
Iter: 14600 Train mse: 6.680019378662109
Iter: 14700 Train mse: 4.07379674911499
Iter: 14800 Train mse: 3.4007933139801025
Iter: 14900 Train mse: 4.17680549621582
Iter: 15000 Train mse: 6.275625228881836
Iter: 15100 Train mse: 2.1222238540649414
Iter: 15200 Train mse: 5.368534564971924
Iter: 15300 Train mse: 4.187286376953125
Iter: 15400 Train mse: 4.97012996673584
Iter: 15500 Train mse: 6.607357025146484
Iter: 15600 Train mse: 6.251296520233154
Iter: 15700 Train mse: 2.80107045173645
Iter: 15800 Train mse: 5.52559757232666
Iter: 15900 Train mse: 4.671032428741455
Iter: 16000 Train mse: 4.626405715942383
Iter: 16100 Train mse: 3.716233730316162
Iter: 16200 Train mse: 5.265080451965332
Iter: 16300 Train mse: 1.6458630561828613
Iter: 16400 Train mse: 4.57540225982666
Iter: 16500 Train mse: 4.35990047454834
Iter: 16600 Train mse: 5.170538902282715
Iter: 16700 Train mse: 3.832230567932129
Iter: 16800 Train mse: 5.06684684753418
Iter: 16900 Train mse: 4.893810272216797
Iter: 17000 Train mse: 3.8961234092712402
Iter: 17100 Train mse: 5.44020938873291
Iter: 17200 Train mse: 4.011006832122803
Iter: 17300 Train mse: 3.7675507068634033
Iter: 17400 Train mse: 4.694486618041992
Iter: 17500 Train mse: 4.956770896911621
Iter: 17600 Train mse: 2.4209139347076416
Iter: 17700 Train mse: 3.423776626586914
Iter: 17800 Train mse: 3.631559371948242
Iter: 17900 Train mse: 3.187343120574951
Iter: 18000 Train mse: 4.334377288818359
Iter: 18100 Train mse: 5.154454231262207
Iter: 18200 Train mse: 4.3096160888671875
Iter: 18300 Train mse: 6.4376220703125
Iter: 18400 Train mse: 3.515423536300659
Iter: 18500 Train mse: 4.815049171447754
Iter: 18600 Train mse: 5.054441452026367
Iter: 18700 Train mse: 5.284633636474609
Iter: 18800 Train mse: 4.841183662414551
Iter: 18900 Train mse: 6.679586410522461
Iter: 19000 Train mse: 4.05303955078125
Iter: 19100 Train mse: 3.757652997970581
Iter: 19200 Train mse: 2.543212890625
Iter: 19300 Train mse: 4.02554988861084
Iter: 19400 Train mse: 3.6791210174560547
Iter: 19500 Train mse: 4.428834438323975
Iter: 19600 Train mse: 3.743673324584961
Iter: 19700 Train mse: 4.254785537719727
Iter: 19800 Train mse: 4.441731929779053
Iter: 19900 Train mse: 2.9214909076690674

Testing on test-set...
pred                      real
115.80153                 125.20100000000001
115.63622                 125.95100000000001
115.41263                 127.59100000000001
115.16629                 127.461
114.86955                 125.571
114.49907                 125.20100000000001
114.03725                 123.061
113.525566                121.301
112.91401                 119.541
112.21203                 117.15100000000001
111.52965                 115.391
110.8746                  112.241
110.24277                 108.721
122.13758                 126.416
122.070816                127.696
121.98422                 128.086
121.88294                 126.96600000000001
121.75644                 126.086
121.57792                 126.986
121.369545                126.616
121.099304                124.10600000000001
120.72737                 123.236
120.20115                 121.10600000000001
119.52357                 119.60600000000001
118.55959                 117.976
117.20025                 116.476
115.54607                 113.07600000000001
113.52918                 111.07600000000001
127.44258                 118.12899999999999
127.43823                 119.319
127.43267                 122.779
127.42549                 124.809
127.41716                 126.959
127.40638                 128.629
127.39214                 129.099
127.37481                 127.899
127.35152                 125.499
127.31427                 124.04899999999999
127.26232                 123.689
127.178375                121.399
127.027596                120.319
126.73627                 119.229
126.21046                 117.789
125.121605                116.229
122.75197                 114.779
118.321915                112.139
111.185394                109.619
128.57584                 117.195
128.5666                  118.595
128.55446                 122.765
128.5383                  125.045
128.51884                 127.315
128.49272                 129.095
128.45694                 129.235
128.4121                  127.365
128.35112                 124.355
128.2548                  122.365
128.12584                 122.375
127.93                    120.755
127.60397                 119.135
127.02202                 118.145
126.04359                 115.645
124.153465                113.775
120.416016                110.515
114.48122                 108.265
118.323845                127.12200000000001
118.273346                125.992
118.23865                 125.87200000000001
118.23601                 126.632
118.2865                  126.64200000000001
118.40919                 124.512
118.63101                 123.39200000000001
118.96359                 121.762
119.33266                 119.632
119.66418                 118.12200000000001
119.69932                 115.37200000000001
119.03099                 113.492
117.12377                 109.22200000000001
113.24102                 106.58200000000001
125.252846                121.851
125.19002                 124.001
125.11833                 126.661
125.02855                 128.311
124.91649                 128.83100000000002
124.791595                127.581
124.64457                 125.211
124.45227                 122.211
124.2463                  122.101
124.00044                 120.98100000000001
123.68482                 119.111
123.25366                 117.741
122.68833                 116.241
121.820435                114.751
120.4141                  112.251
118.33786                 108.991
115.14227                 106.111
106.074234                127.564
105.90803                 128.454
105.703285                129.35399999999998
105.453865                129.494

Test batch size:  100
Test mse:  58.047153609816476

================================================================================================================================================== CVX fit =====================================================
========================================================================================================

(tf_env) ]0;sid@element: /mnt/c/Users/sidda/Documents/Programming/cvx_opt/airfoil_noise[01;32msid@element[00m:[01;34m/mnt/c/Users/sidda/Documents/Programming/cvx_opt/airfoil_noise[00m$ 
(tf_env) ]0;sid@element: /mnt/c/Users/sidda/Documents/Programming/cvx_opt/airfoil_noise[01;32msid@element[00m:[01;34m/mnt/c/Users/sidda/Documents/Programming/cvx_opt/airfoil_noise[00m$ python fit.py 
Load data of form...
800           1000.000000
0                0.000000
0.3048           0.304800
71.3            71.300000
0.00266337       0.002663
126.201        125.201000
Name: 0, dtype: float64
Fitting  150 / 1402
Setting up constraints...
Setting up objective...
Solving...
-----------------------------------------------------------------
           OSQP v0.3.1  -  Operator Splitting QP Solver
              (c) Bartolomeo Stellato,  Goran Banjac
        University of Oxford  -  Stanford University 2018
-----------------------------------------------------------------
problem:  variables n = 1050, constraints m = 22500
          nnz(P) + nnz(A) = 130574
settings: linear system solver = suitesparse ldl,
          eps_abs = 1.0e-03, eps_rel = 1.0e-03,
          eps_prim_inf = 1.0e-04, eps_dual_inf = 1.0e-04,
          rho = 1.00e-01 (adaptive),
          sigma = 1.00e-06, alpha = 1.60, max_iter = 4000
          check_termination: on (interval 25),
          scaling: on, scaled_termination: off
          warm start: on, polish: on

iter   objective    pri res    dua res    rho        time
   1   0.0000e+00   1.32e+02   1.32e+04   1.00e-01   2.40e-01s
 200   5.3890e+02   7.04e+00   5.84e+00   1.00e-01   5.63e-01s
 400   5.5129e+02   4.42e+00   3.29e+00   1.00e-01   9.07e-01s
 600   5.5866e+02   5.69e+00   2.21e+00   1.00e-01   1.24e+00s
 800   5.6685e+02   2.27e+00   9.11e-01   1.00e-01   1.57e+00s
1000   5.7235e+02   9.01e-01   3.63e-01   1.00e-01   1.90e+00s
1200   5.7535e+02   8.41e-01   7.76e-01   1.00e-01   2.23e+00s
1400   5.7721e+02   7.63e-01   3.00e-01   1.00e-01   2.55e+00s
1600   5.7829e+02   6.91e-01   8.43e-02   1.00e-01   2.88e+00s
1800   5.7906e+02   6.40e-01   2.48e-02   1.00e-01   3.21e+00s
2000   5.8004e+02   5.32e-01   1.80e-01   6.99e-01   3.58e+00s
2200   5.8073e+02   3.27e-01   3.46e-02   6.99e-01   3.91e+00s
2400   5.8091e+02   2.06e-01   6.31e-02   6.99e-01   4.25e+00s
2600   5.8099e+02   1.31e-01   2.19e-02   6.99e-01   4.59e+00s
2700   5.8101e+02   1.05e-01   1.48e-02   6.99e-01   4.75e+00s

status:               solved
solution polish:      unsuccessful
number of iterations: 2700
optimal objective:    581.0102
run time:             4.76e+00s
optimal rho estimate: 1.01e+00

Testing on test-set...
pred                      real
161.73943387455893        125.20100000000001
161.5630889765468         125.95100000000001
161.31620611932982        127.59100000000001
161.03405428251043        127.461
160.68136448648616        125.571
160.22286775165463        125.20100000000001
159.6232950984134         123.061
158.9179155063649         121.301
158.0009220367018         119.541
156.80177673021933        117.15100000000001
155.39101754612233        115.391
153.62756856600103        112.241
151.15873999383123        108.721
167.09966714166043        126.416
167.0079677935177         127.696
166.8880532613311         128.086
166.74697734111152        126.96600000000001
166.57063244083707        126.086
166.32374958045284        126.986
166.04159774001369        126.616
165.6889079394648         124.10600000000001
165.2304111987512         123.236
164.63083853781805        121.10600000000001
163.92545893672022        119.60600000000001
163.00846545529305        117.976
161.80932013342675        116.476
160.3985609312311         113.07600000000001
158.63511192848654        111.07600000000001
158.14986166417657        118.12899999999999
158.11459268471341        119.319
158.06874301141136        122.779
158.008785746324          124.809
157.93824778739773        126.959
157.84654844079355        128.629
157.7266339106189         129.099
157.58555799276633        127.899
157.4092130954506         125.499
157.16233023920861        124.04899999999999
156.8801784035035         123.689
156.5274886088721         121.399
156.06899187585125        120.319
155.46941922497786        119.229
154.76403963571505        117.789
153.84704616967338        116.229
152.6479008679266         114.779
151.23714168940097        112.139
149.47369271624393        109.619
145.62586448721328        117.195
145.4516300655035         118.595
145.22512531728077        122.765
144.92892680037411        125.045
144.58045795695455        127.315
144.12744846050907        129.095
143.53505142669576        129.235
142.8381137398566         127.365
141.96694163130763        124.355
141.2629349078994         122.365
140.74900407575723        122.375
140.10659053557953        120.755
139.27145293334854        119.135
138.39034464846992        118.145
137.68496505920712        115.645
136.76797159316544        113.775
135.56882629141867        110.515
134.15806711289304        108.265
150.46233127666474        127.12200000000001
150.32125535825503        125.992
150.14491046024293        125.87200000000001
149.89802760302592        126.632
149.61587576620653        126.64200000000001
149.26318597018226        124.512
148.80468923535074        123.39200000000001
148.2051165821095         121.762
147.499736990061          119.632
146.5827435203979         118.12200000000001
145.38359821391546        115.37200000000001
143.97283902981843        113.492
142.20939004969713        109.22200000000001
139.74056147752734        106.58200000000001
139.83582360345815        121.851
139.72661330162794        124.001
139.59813059359237        126.661
139.43110307314618        128.311
139.2126824694858         128.83100000000002
138.95571705341473        127.581
138.63451028332588        125.211
138.18482080520147        122.211
137.67088997305933        122.101
137.02847643288163        120.98100000000001
136.1933388306506         119.111
135.10123581234853        117.741
133.81640873199314        116.241
132.1461335275311         114.751
129.96192749092694        112.251
127.39227333021616        108.991
124.18020562932766        106.111
133.18472078298137        127.564
132.48793390806642        128.454
131.58211097067695        129.35399999999998
130.39757328332152        129.494
Test batch size:  100
Test mse:  910.8582108333107

Prob solve time:  4.755357


Task: Predict radius of tumor given 8 features. We focus only on Malignant tumors.

nn test mse: 2.54543
cvx fit test mse: 1.511938

========================================================nn log =========================================
np seed:  2438
tf seed:  1480
Data snippit...
842302,M,17.99,10.38,122.8,1001,0.1184,0.2776,0.3001,0.1471,0.2419,0.07871,1.095,0.9053,8.589,153.4,0.006399,0.04904,0.05373,0.01587,0.03003,0.006193,25.38,17.33,184.6,2019,0.1622,0.6656,0.7119,0.2654,0.4601,0.1189    842517,M,20.57,17.77,132.9,1326,0.08474,0.0786...
Name: 0, dtype: object
Num rows:  568
WARNING:tensorflow:From /mnt/c/Users/sidda/Documents/Programming/tf_env/lib/python3.5/site-packages/tensorflow/python/util/tf_should_use.py:118: initialize_all_variables (from tensorflow.python.ops.variables) is deprecated and will be removed after 2017-03-02.
Instructions for updating:
Use `tf.global_variables_initializer` instead.
2018-08-05 12:36:51.975435: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
Iter: 0 Cost: 394.20062255859375
Iter: 100 Cost: 18.216773986816406
Iter: 200 Cost: 3.201097011566162
Iter: 300 Cost: 2.880624532699585
Iter: 400 Cost: 1.8794984817504883
Iter: 500 Cost: 1.9406524896621704
Iter: 600 Cost: 0.9185103178024292
Iter: 700 Cost: 1.1574839353561401
Iter: 800 Cost: 2.2474582195281982
Iter: 900 Cost: 1.6222352981567383
Iter: 1000 Cost: 1.389528751373291
Iter: 1100 Cost: 1.5648962259292603
Iter: 1200 Cost: 1.0510531663894653
Iter: 1300 Cost: 0.8699014186859131
Iter: 1400 Cost: 0.8571363687515259
Iter: 1500 Cost: 0.28060391545295715
Iter: 1600 Cost: 0.6040934324264526
Iter: 1700 Cost: 0.8682733774185181
Iter: 1800 Cost: 0.6929444074630737
Iter: 1900 Cost: 0.44342657923698425
Iter: 2000 Cost: 0.2648281753063202
Iter: 2100 Cost: 0.875748872756958
Iter: 2200 Cost: 1.0775809288024902
Iter: 2300 Cost: 1.2331095933914185
Iter: 2400 Cost: 0.23506620526313782
Iter: 2500 Cost: 0.3925582468509674
Iter: 2600 Cost: 0.5457688570022583
Iter: 2700 Cost: 0.3907849192619324
Iter: 2800 Cost: 0.3686353862285614
Iter: 2900 Cost: 0.19477981328964233
Iter: 3000 Cost: 0.42764294147491455
Iter: 3100 Cost: 0.48670560121536255
Iter: 3200 Cost: 0.4843314290046692
Iter: 3300 Cost: 0.2197718620300293
Iter: 3400 Cost: 0.394605815410614
Iter: 3500 Cost: 0.48147183656692505
Iter: 3600 Cost: 0.5404416918754578
Iter: 3700 Cost: 0.25234168767929077
Iter: 3800 Cost: 0.15126419067382812
Iter: 3900 Cost: 0.11703455448150635
Iter: 4000 Cost: 0.12898436188697815
Iter: 4100 Cost: 0.4498700499534607
Iter: 4200 Cost: 0.22560369968414307
Iter: 4300 Cost: 0.15468363463878632
Iter: 4400 Cost: 0.320828378200531
Iter: 4500 Cost: 0.2650024890899658
Iter: 4600 Cost: 0.15148332715034485
Iter: 4700 Cost: 0.10205078125
Iter: 4800 Cost: 0.20652255415916443
Iter: 4900 Cost: 0.19103381037712097
Iter: 5000 Cost: 0.1363229602575302
Iter: 5100 Cost: 0.1276722252368927
Iter: 5200 Cost: 0.237621009349823
Iter: 5300 Cost: 0.19977471232414246
Iter: 5400 Cost: 0.15280789136886597
Iter: 5500 Cost: 0.17156805098056793
Iter: 5600 Cost: 0.28293895721435547
Iter: 5700 Cost: 0.17202870547771454
Iter: 5800 Cost: 0.24942941963672638
Iter: 5900 Cost: 0.22350576519966125
Iter: 6000 Cost: 0.16783669590950012
Iter: 6100 Cost: 0.10604231059551239
Iter: 6200 Cost: 0.0981430932879448
Iter: 6300 Cost: 0.09788186103105545
Iter: 6400 Cost: 0.15760447084903717
Iter: 6500 Cost: 0.06654778122901917
Iter: 6600 Cost: 0.07759661972522736
Iter: 6700 Cost: 0.13474348187446594
Iter: 6800 Cost: 0.08569426834583282
Iter: 6900 Cost: 0.08816385269165039
Iter: 7000 Cost: 0.1445242017507553
Iter: 7100 Cost: 0.13870775699615479
Iter: 7200 Cost: 0.11062848567962646
Iter: 7300 Cost: 0.15175792574882507
Iter: 7400 Cost: 0.11101805418729782
Iter: 7500 Cost: 0.04604657366871834
Iter: 7600 Cost: 0.06411583721637726
Iter: 7700 Cost: 0.14892083406448364
Iter: 7800 Cost: 0.09151634573936462
Iter: 7900 Cost: 0.06867287307977676
Iter: 8000 Cost: 0.1021866500377655
Iter: 8100 Cost: 0.14268162846565247
Iter: 8200 Cost: 0.06466290354728699
Iter: 8300 Cost: 0.06213841214776039
Iter: 8400 Cost: 0.0908127874135971
Iter: 8500 Cost: 0.07567726820707321
Iter: 8600 Cost: 0.04982370138168335
Iter: 8700 Cost: 0.07454784214496613
Iter: 8800 Cost: 0.06460119038820267
Iter: 8900 Cost: 0.05483834818005562
Iter: 9000 Cost: 0.06956636905670166
Iter: 9100 Cost: 0.07207957655191422
Iter: 9200 Cost: 0.05135233700275421
Iter: 9300 Cost: 0.11269954591989517
Iter: 9400 Cost: 0.04904239624738693
Iter: 9500 Cost: 0.10800305008888245
Iter: 9600 Cost: 0.046989135444164276
Iter: 9700 Cost: 0.03672659769654274
Iter: 9800 Cost: 0.07028117775917053
Iter: 9900 Cost: 0.054172612726688385
Iter: 10000 Cost: 0.046383973211050034
Iter: 10100 Cost: 0.029827434569597244
Iter: 10200 Cost: 0.06856421381235123
Iter: 10300 Cost: 0.06571467220783234
Iter: 10400 Cost: 0.04216786473989487
Iter: 10500 Cost: 0.06295916438102722
Iter: 10600 Cost: 0.0420658253133297
Iter: 10700 Cost: 0.05783156678080559
Iter: 10800 Cost: 0.09210371226072311
Iter: 10900 Cost: 0.043116968125104904
Iter: 11000 Cost: 0.034126318991184235
Iter: 11100 Cost: 0.054724112153053284
Iter: 11200 Cost: 0.07601356506347656
Iter: 11300 Cost: 0.03172844648361206
Iter: 11400 Cost: 0.05516951531171799
Iter: 11500 Cost: 0.045491524040699005
Iter: 11600 Cost: 0.049049876630306244
Iter: 11700 Cost: 0.03960777074098587
Iter: 11800 Cost: 0.03915403038263321
Iter: 11900 Cost: 0.04754733294248581
Iter: 12000 Cost: 0.06874531507492065
Iter: 12100 Cost: 0.04964257404208183
Iter: 12200 Cost: 0.0527159608900547
Iter: 12300 Cost: 0.03633100911974907
Iter: 12400 Cost: 0.03286653012037277
Iter: 12500 Cost: 0.056185267865657806
Iter: 12600 Cost: 0.028851250186562538
Iter: 12700 Cost: 0.037939999252557755
Iter: 12800 Cost: 0.03373816981911659
Iter: 12900 Cost: 0.04200367629528046
Iter: 13000 Cost: 0.019379418343305588
Iter: 13100 Cost: 0.027552349492907524
Iter: 13200 Cost: 0.04467453062534332
Iter: 13300 Cost: 0.04122673720121384
Iter: 13400 Cost: 0.04229138046503067
Iter: 13500 Cost: 0.04144781455397606
Iter: 13600 Cost: 0.02650928869843483
Iter: 13700 Cost: 0.0435786135494709
Iter: 13800 Cost: 0.03449075669050217
Iter: 13900 Cost: 0.029166171327233315
Iter: 14000 Cost: 0.04439001902937889
Iter: 14100 Cost: 0.018725186586380005
Iter: 14200 Cost: 0.029321832582354546
Iter: 14300 Cost: 0.04468228295445442
Iter: 14400 Cost: 0.031067386269569397
Iter: 14500 Cost: 0.022682279348373413
Iter: 14600 Cost: 0.03972312808036804
Iter: 14700 Cost: 0.02451183833181858
Iter: 14800 Cost: 0.029949942603707314
Iter: 14900 Cost: 0.02880045771598816
Iter: 15000 Cost: 0.03716437146067619
Iter: 15100 Cost: 0.03409000486135483
Iter: 15200 Cost: 0.027892353013157845
Iter: 15300 Cost: 0.039089083671569824
Iter: 15400 Cost: 0.02439030446112156
Iter: 15500 Cost: 0.03178215026855469
Iter: 15600 Cost: 0.04501936212182045
Iter: 15700 Cost: 0.013726366683840752
Iter: 15800 Cost: 0.04643326997756958
Iter: 15900 Cost: 0.02677299827337265
Iter: 16000 Cost: 0.015271909534931183
Iter: 16100 Cost: 0.03508799895644188
Iter: 16200 Cost: 0.029645537957549095
Iter: 16300 Cost: 0.02437562495470047
Iter: 16400 Cost: 0.01892208307981491
Iter: 16500 Cost: 0.025245552882552147
Iter: 16600 Cost: 0.028269223868846893
Iter: 16700 Cost: 0.017147142440080643
Iter: 16800 Cost: 0.017578402534127235
Iter: 16900 Cost: 0.029183175414800644
Iter: 17000 Cost: 0.023773759603500366
Iter: 17100 Cost: 0.017621727660298347
Iter: 17200 Cost: 0.01818762719631195
Iter: 17300 Cost: 0.038036927580833435
Iter: 17400 Cost: 0.03502415120601654
Iter: 17500 Cost: 0.03545346111059189
Iter: 17600 Cost: 0.0245053730905056
Iter: 17700 Cost: 0.02864988148212433
Iter: 17800 Cost: 0.040128208696842194
Iter: 17900 Cost: 0.022760367020964622
Iter: 18000 Cost: 0.024628497660160065
Iter: 18100 Cost: 0.03259650990366936
Iter: 18200 Cost: 0.022808000445365906
Iter: 18300 Cost: 0.026905495673418045
Iter: 18400 Cost: 0.033047378063201904
Iter: 18500 Cost: 0.010006120428442955
Iter: 18600 Cost: 0.030382568016648293
Iter: 18700 Cost: 0.019000951200723648
Iter: 18800 Cost: 0.0319582000374794
Iter: 18900 Cost: 0.020396409556269646
Iter: 19000 Cost: 0.03736370801925659
Iter: 19100 Cost: 0.015415002591907978
Iter: 19200 Cost: 0.032520804554224014
Iter: 19300 Cost: 0.014113005250692368
Iter: 19400 Cost: 0.020842328667640686
Iter: 19500 Cost: 0.025641292333602905
Iter: 19600 Cost: 0.022433988749980927
Iter: 19700 Cost: 0.022272001951932907
Iter: 19800 Cost: 0.020370446145534515
Iter: 19900 Cost: 0.02400604449212551

Testing on test-set...
pred                      real
21.861217                 20.57
21.98851                  19.69
12.402485                 11.42
22.746414                 20.29
13.487238                 12.45
20.460821                 18.25
14.967436                 13.71
14.022812                 13.0
13.588612                 12.46
17.499416                 16.02
17.37994                  15.78
21.411434                 19.17
17.366907                 15.85
14.72469                  13.73
15.811895                 14.54
16.218283                 14.68
17.775475                 16.13
22.379791                 19.81
16.70231                  15.34
22.877655                 21.16
18.571453                 16.65
18.267807                 17.14
15.9020195                14.58
20.908705                 18.61
16.763409                 15.3
19.293722                 17.57
20.66148                  18.63
12.531231                 11.84
18.240337                 17.02
20.989334                 19.27
17.663929                 16.13
18.268768                 16.74
15.565908                 14.25
16.304106                 14.99
14.573322                 13.48
14.754633                 13.44
11.81407                  10.95
20.57985                  19.07
14.274374                 13.28
14.113644                 13.17
20.783218                 18.65
14.235685                 13.17
20.196413                 18.22
16.488218                 15.1
21.173367                 19.21
15.986917                 14.71
15.41566                  14.25
13.507916                 12.68
16.385437                 14.78
21.09459                  18.94
19.0204                   17.2
15.171055                 13.8
17.717707                 16.07
19.384174                 18.05
22.784136                 20.18
26.960943                 25.22
19.770771                 19.1
20.648525                 18.46
15.805683                 14.48
20.647482                 19.02
16.849157                 15.37
16.548836                 15.06
22.11128                  20.26

Test batch size:  63
Test mse:  2.545436088005978

================================================================ cvx fit log ===================================================================================================================================

(tf_env) ]0;sid@element: /mnt/c/Users/sidda/Documents/Programming/cvx_opt/breast_cancer[01;32msid@element[00m:[01;34m/mnt/c/Users/sidda/Documents/Programming/cvx_opt/breast_cancer[00m$ python fit.py 
Load data of form...
842302,M,17.99,10.38,122.8,1001,0.1184,0.2776,0.3001,0.1471,0.2419,0.07871,1.095,0.9053,8.589,153.4,0.006399,0.04904,0.05373,0.01587,0.03003,0.006193,25.38,17.33,184.6,2019,0.1622,0.6656,0.7119,0.2654,0.4601,0.1189    842517,M,20.57,17.77,132.9,1326,0.08474,0.0786...
Name: 0, dtype: object
Num rows:  568
Fitting  148 / 148
Setting up constraints...
Setting up objective...
Solving...
-----------------------------------------------------------------
           OSQP v0.3.1  -  Operator Splitting QP Solver
              (c) Bartolomeo Stellato,  Goran Banjac
        University of Oxford  -  Stanford University 2018
-----------------------------------------------------------------
problem:  variables n = 1480, constraints m = 21904
          nnz(P) + nnz(A) = 219384
settings: linear system solver = suitesparse ldl,
          eps_abs = 1.0e-03, eps_rel = 1.0e-03,
          eps_prim_inf = 1.0e-04, eps_dual_inf = 1.0e-04,
          rho = 1.00e-01 (adaptive),
          sigma = 1.00e-06, alpha = 1.60, max_iter = 4000
          check_termination: on (interval 25),
          scaling: on, scaled_termination: off
          warm start: on, polish: on

iter   objective    pri res    dua res    rho        time
   1   0.0000e+00   2.81e+01   2.81e+03   1.00e-01   2.08e-01s
 200   8.3462e-02   3.23e-01   1.99e-02   9.28e-03   7.40e-01s
 400   9.3489e-02   2.52e-01   5.26e-03   9.28e-03   1.23e+00s
 600   1.0065e-01   1.95e-01   4.99e-03   9.28e-03   1.72e+00s
 800   1.0729e-01   1.67e-01   4.39e-03   9.28e-03   2.21e+00s
1000   1.1173e-01   1.57e-01   2.65e-03   9.28e-03   2.71e+00s
1200   1.1466e-01   1.51e-01   4.08e-03   9.28e-03   3.22e+00s
1400   1.1748e-01   1.57e-01   2.06e-03   9.28e-03   3.71e+00s
1600   1.1968e-01   1.74e-01   8.38e-04   9.28e-03   4.23e+00s
1800   1.2136e-01   1.67e-01   1.83e-03   9.28e-03   4.70e+00s
2000   1.2258e-01   1.60e-01   2.77e-03   9.28e-03   5.20e+00s
2200   1.2363e-01   1.54e-01   1.48e-03   9.28e-03   5.70e+00s
2400   1.2437e-01   1.51e-01   1.54e-03   9.28e-03   6.19e+00s
2600   1.2505e-01   1.49e-01   1.46e-03   9.28e-03   6.69e+00s
2800   1.2570e-01   1.47e-01   1.29e-03   9.28e-03   7.18e+00s
3000   1.2654e-01   1.13e-01   9.21e-04   9.28e-03   7.67e+00s
3200   1.2785e-01   1.04e-01   9.26e-04   9.28e-03   8.13e+00s
3400   1.2890e-01   9.49e-02   7.15e-04   9.28e-03   8.61e+00s
3600   1.2998e-01   8.90e-02   1.50e-03   9.28e-03   9.07e+00s
3650   1.3020e-01   7.48e-02   5.97e-04   9.28e-03   9.19e+00s

status:               solved
solution polish:      unsuccessful
number of iterations: 3650
optimal objective:    0.1302
run time:             9.19e+00s
optimal rho estimate: 9.64e-03

Testing on test-set...
pred                      real
20.592633584699307        20.57
19.480697977736448        19.69
11.396673754625962        11.42
22.35734020467749         20.29
12.534326867923031        12.45
18.27084229985183         18.25
13.789265494968653        13.71
13.262787791662983        13.0
12.33834573602321         12.46
16.045331339175455        16.02
15.716822542776658        15.78
20.094143713032235        19.17
15.88360544756837         15.85
14.356801984570147        13.73
14.536463482599022        14.54
14.761584614392802        14.68
16.159463458828274        16.13
19.829356257916178        19.81
15.421358389210717        15.34
21.047688904113617        21.16
16.565920775694917        16.65
17.588981013656824        17.14
14.653193184419715        14.58
18.62789527933921         18.61
15.255104768420995        15.3
18.5051867120142          17.57
18.430606053587745        18.63
11.888608441582528        11.84
23.129005212640173        17.02
19.051134951450123        19.27
16.127017187818286        16.13
16.62446537351082         16.74
14.307794047382885        14.25
15.22631047634886         14.99
13.41501438543335         13.48
13.541534281836157        13.44
12.38377084132918         10.95
19.141806727119462        19.07
13.226605182633117        13.28
13.10336802618491         13.17
18.55001977320657         18.65
16.383999443911243        13.17
18.21294414734711         18.22
15.152656104504324        15.1
19.20640265485723         19.21
14.509200996813732        14.71
14.152421469426868        14.25
13.365584083386693        12.68
14.86433162716512         14.78
18.864243643267788        18.94
16.947437088506252        17.2
13.864763596505359        13.8
16.039142864394524        16.07
18.011211259495564        18.05
22.826320411669844        20.18
26.72158953700801         25.22
24.426636439478806        19.1
18.567093369782036        18.46
14.541956800184666        14.48
18.482076806046596        19.02
15.414047623477924        15.37
15.05220495993054         15.06
20.13181806320318         20.26
Test batch size:  63
Test mse:  1.5119380980790196

Prob solve time:  9.194925
(tf_env) ]0;sid@element: /mnt/c/Users/sidda/Documents/Programming/cvx_opt/breast_cancer[01;32msid@element[00m:[01;34m/mnt/c/Users/sidda/Documents/Programming/cvx_opt/breast_cancer[00m$ exit
exit

Script done on Sun 05 Aug 2018 12:42:02 PM DST

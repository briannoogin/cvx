Task: Given 4 attributes of a car, predict its mpg. Both models trained and tested on same subset of data.
Neural network test MSE: 26.341473774413387
cvx fit test MSE: 564.3047231264828

Logged output:
================================================ 32 unit 1 layer neural network ======================
np seed:  8767
tf seed:  4021
Data snippit...
mpg                                    18
cylinders                               8
displacement                          307
horsepower                          130.0
weight                               3504
acceleration                           12
model_year                             70
origin                                  1
car_name        chevrolet chevelle malibu
Name: 0, dtype: object
WARNING:tensorflow:From /mnt/c/Users/sidda/Documents/Programming/tf_env/lib/python3.5/site-packages/tensorflow/python/util/tf_should_use.py:118: initialize_all_variables (from tensorflow.python.ops.variables) is deprecated and will be removed after 2017-03-02.
Instructions for updating:
Use `tf.global_variables_initializer` instead.
2018-08-05 12:02:47.887791: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
Iter: 0 Cost: 719.596923828125
Iter: 100 Cost: 22.235170364379883
Iter: 200 Cost: 27.63010025024414
Iter: 300 Cost: 9.331233024597168
Iter: 400 Cost: 10.702167510986328
Iter: 500 Cost: 30.315509796142578
Iter: 600 Cost: 15.775932312011719
Iter: 700 Cost: 16.091144561767578
Iter: 800 Cost: 13.35011100769043
Iter: 900 Cost: 27.042478561401367
Iter: 1000 Cost: 16.896297454833984
Iter: 1100 Cost: 13.773660659790039
Iter: 1200 Cost: 12.06683349609375
Iter: 1300 Cost: 12.147860527038574
Iter: 1400 Cost: 15.869396209716797
Iter: 1500 Cost: 16.57459259033203
Iter: 1600 Cost: 7.423685550689697
Iter: 1700 Cost: 14.513581275939941
Iter: 1800 Cost: 14.661334991455078
Iter: 1900 Cost: 10.851932525634766
Iter: 2000 Cost: 10.94279670715332
Iter: 2100 Cost: 9.830873489379883
Iter: 2200 Cost: 7.832050323486328
Iter: 2300 Cost: 11.179641723632812
Iter: 2400 Cost: 11.686004638671875
Iter: 2500 Cost: 7.234643936157227
Iter: 2600 Cost: 11.347464561462402
Iter: 2700 Cost: 6.914337158203125
Iter: 2800 Cost: 11.578447341918945
Iter: 2900 Cost: 11.235450744628906
Iter: 3000 Cost: 16.466026306152344
Iter: 3100 Cost: 23.751239776611328
Iter: 3200 Cost: 10.59338092803955
Iter: 3300 Cost: 7.0030670166015625
Iter: 3400 Cost: 24.370025634765625
Iter: 3500 Cost: 9.848312377929688
Iter: 3600 Cost: 18.92435073852539
Iter: 3700 Cost: 9.106025695800781
Iter: 3800 Cost: 14.070426940917969
Iter: 3900 Cost: 12.287023544311523
Iter: 4000 Cost: 8.631185531616211
Iter: 4100 Cost: 11.492637634277344
Iter: 4200 Cost: 10.95048713684082
Iter: 4300 Cost: 11.908939361572266
Iter: 4400 Cost: 7.947017669677734
Iter: 4500 Cost: 15.93252182006836
Iter: 4600 Cost: 21.022693634033203
Iter: 4700 Cost: 9.885009765625
Iter: 4800 Cost: 12.71159553527832
Iter: 4900 Cost: 7.74442195892334
Iter: 5000 Cost: 5.122936248779297
Iter: 5100 Cost: 22.599287033081055
Iter: 5200 Cost: 18.48879623413086
Iter: 5300 Cost: 15.737221717834473
Iter: 5400 Cost: 12.222009658813477
Iter: 5500 Cost: 7.9450860023498535
Iter: 5600 Cost: 21.36663818359375
Iter: 5700 Cost: 11.579307556152344
Iter: 5800 Cost: 20.20467758178711
Iter: 5900 Cost: 10.920270919799805
Iter: 6000 Cost: 16.448274612426758
Iter: 6100 Cost: 16.08807945251465
Iter: 6200 Cost: 16.716434478759766
Iter: 6300 Cost: 12.315546035766602
Iter: 6400 Cost: 10.575687408447266
Iter: 6500 Cost: 8.778461456298828
Iter: 6600 Cost: 13.386117935180664
Iter: 6700 Cost: 17.246572494506836
Iter: 6800 Cost: 8.912215232849121
Iter: 6900 Cost: 9.618271827697754
Iter: 7000 Cost: 13.078718185424805
Iter: 7100 Cost: 10.083539962768555
Iter: 7200 Cost: 9.383817672729492
Iter: 7300 Cost: 12.505674362182617
Iter: 7400 Cost: 5.556530952453613
Iter: 7500 Cost: 14.744684219360352
Iter: 7600 Cost: 8.262361526489258
Iter: 7700 Cost: 13.543853759765625
Iter: 7800 Cost: 12.894577980041504
Iter: 7900 Cost: 11.482461929321289
Iter: 8000 Cost: 28.127391815185547
Iter: 8100 Cost: 18.778064727783203
Iter: 8200 Cost: 11.838972091674805
Iter: 8300 Cost: 17.518877029418945
Iter: 8400 Cost: 18.919158935546875
Iter: 8500 Cost: 12.970552444458008
Iter: 8600 Cost: 13.430813789367676
Iter: 8700 Cost: 6.391012191772461
Iter: 8800 Cost: 17.04332733154297
Iter: 8900 Cost: 21.343530654907227
Iter: 9000 Cost: 14.353645324707031
Iter: 9100 Cost: 16.594881057739258
Iter: 9200 Cost: 16.826034545898438
Iter: 9300 Cost: 10.839361190795898
Iter: 9400 Cost: 11.497225761413574
Iter: 9500 Cost: 11.703594207763672
Iter: 9600 Cost: 18.653545379638672
Iter: 9700 Cost: 11.57867431640625
Iter: 9800 Cost: 19.18662452697754
Iter: 9900 Cost: 7.783663749694824
Iter: 10000 Cost: 17.766942977905273
Iter: 10100 Cost: 9.347652435302734
Iter: 10200 Cost: 6.348203659057617
Iter: 10300 Cost: 18.170391082763672
Iter: 10400 Cost: 13.823524475097656
Iter: 10500 Cost: 5.278684616088867
Iter: 10600 Cost: 22.86391830444336
Iter: 10700 Cost: 7.868741512298584
Iter: 10800 Cost: 14.814706802368164
Iter: 10900 Cost: 10.68603229522705
Iter: 11000 Cost: 15.719048500061035
Iter: 11100 Cost: 16.657943725585938
Iter: 11200 Cost: 16.902435302734375
Iter: 11300 Cost: 9.284590721130371
Iter: 11400 Cost: 11.403409004211426
Iter: 11500 Cost: 8.091178894042969
Iter: 11600 Cost: 21.25751304626465
Iter: 11700 Cost: 14.54688835144043
Iter: 11800 Cost: 11.683735847473145
Iter: 11900 Cost: 7.4287519454956055
Iter: 12000 Cost: 7.719603538513184
Iter: 12100 Cost: 14.424678802490234
Iter: 12200 Cost: 18.80665397644043
Iter: 12300 Cost: 13.565625190734863
Iter: 12400 Cost: 15.243553161621094
Iter: 12500 Cost: 7.855363368988037
Iter: 12600 Cost: 7.885683059692383
Iter: 12700 Cost: 23.934490203857422
Iter: 12800 Cost: 24.21031951904297
Iter: 12900 Cost: 26.57386589050293
Iter: 13000 Cost: 11.873851776123047
Iter: 13100 Cost: 16.751644134521484
Iter: 13200 Cost: 15.567646026611328
Iter: 13300 Cost: 20.345911026000977
Iter: 13400 Cost: 9.823365211486816
Iter: 13500 Cost: 10.978655815124512
Iter: 13600 Cost: 11.747298240661621
Iter: 13700 Cost: 19.32379150390625
Iter: 13800 Cost: 7.743820667266846
Iter: 13900 Cost: 12.988035202026367
Iter: 14000 Cost: 14.69542121887207
Iter: 14100 Cost: 11.928792953491211
Iter: 14200 Cost: 16.07891845703125
Iter: 14300 Cost: 7.787067413330078
Iter: 14400 Cost: 19.786500930786133
Iter: 14500 Cost: 14.0415620803833
Iter: 14600 Cost: 14.416755676269531
Iter: 14700 Cost: 9.420272827148438
Iter: 14800 Cost: 12.327213287353516
Iter: 14900 Cost: 12.47038745880127
Iter: 15000 Cost: 6.8568115234375
Iter: 15100 Cost: 20.195959091186523
Iter: 15200 Cost: 4.278703212738037
Iter: 15300 Cost: 9.640377044677734
Iter: 15400 Cost: 30.259708404541016
Iter: 15500 Cost: 12.28524398803711
Iter: 15600 Cost: 20.881990432739258
Iter: 15700 Cost: 16.979862213134766
Iter: 15800 Cost: 8.031266212463379
Iter: 15900 Cost: 26.326820373535156
Iter: 16000 Cost: 10.004448890686035
Iter: 16100 Cost: 14.669439315795898
Iter: 16200 Cost: 9.482934951782227
Iter: 16300 Cost: 8.920780181884766
Iter: 16400 Cost: 7.532279014587402
Iter: 16500 Cost: 9.170059204101562
Iter: 16600 Cost: 6.352543830871582
Iter: 16700 Cost: 25.424701690673828
Iter: 16800 Cost: 10.683355331420898
Iter: 16900 Cost: 18.3448486328125
Iter: 17000 Cost: 9.260641098022461
Iter: 17100 Cost: 8.62364387512207
Iter: 17200 Cost: 14.719927787780762
Iter: 17300 Cost: 11.946670532226562
Iter: 17400 Cost: 25.780792236328125
Iter: 17500 Cost: 9.980710983276367
Iter: 17600 Cost: 12.449219703674316
Iter: 17700 Cost: 16.760894775390625
Iter: 17800 Cost: 25.486862182617188
Iter: 17900 Cost: 8.341081619262695
Iter: 18000 Cost: 16.370519638061523
Iter: 18100 Cost: 13.085283279418945
Iter: 18200 Cost: 15.242569923400879
Iter: 18300 Cost: 17.311809539794922
Iter: 18400 Cost: 6.8510966300964355
Iter: 18500 Cost: 19.824466705322266
Iter: 18600 Cost: 6.734835147857666
Iter: 18700 Cost: 6.726940155029297
Iter: 18800 Cost: 12.284173965454102
Iter: 18900 Cost: 20.17388916015625
Iter: 19000 Cost: 7.947783470153809
Iter: 19100 Cost: 19.051803588867188
Iter: 19200 Cost: 7.437681674957275
Iter: 19300 Cost: 11.289180755615234
Iter: 19400 Cost: 12.282797813415527
Iter: 19500 Cost: 17.659820556640625
Iter: 19600 Cost: 9.663660049438477
Iter: 19700 Cost: 10.455214500427246
Iter: 19800 Cost: 20.6733341217041
Iter: 19900 Cost: 10.220354080200195

Testing on test-set...
pred                      real
18.927124                 18.0
16.72438                  15.0
18.56114                  18.0
18.847569                 16.0
18.979008                 17.0
13.862619                 15.0
13.527084                 14.0
13.669622                 14.0
13.4056635                14.0
15.285189                 15.0
16.86031                  15.0
17.293194                 14.0
17.069378                 15.0
17.77331                  14.0
24.6789                   24.0
32.443996                 22.0
32.118534                 18.0
32.16967                  21.0
26.147308                 27.0
32.61807                  26.0
23.273935                 25.0
24.294659                 24.0
23.365808                 25.0
23.478848                 26.0
32.32315                  21.0
13.918307                 10.0

Test batch size:  26
Test mse:  26.341473774413387

============================================================= cvx fit ==================================
(tf_env) ]0;sid@element: /mnt/c/Users/sidda/Documents/Programming/cvx_opt/mpg_reg[01;32msid@element[00m:[01;34m/mnt/c/Users/sidda/Documents/Programming/cvx_opt/mpg_reg[00m$ python fit.py 
Load data of form...
mpg                                    18
cylinders                               8
displacement                          307
horsepower                          130.0
weight                               3504
acceleration                           12
model_year                             70
origin                                  1
car_name        chevrolet chevelle malibu
Name: 0, dtype: object
Fitting  100 / 366
Setting up constraints...
Setting up objective...
Solving...
-----------------------------------------------------------------
           OSQP v0.3.1  -  Operator Splitting QP Solver
              (c) Bartolomeo Stellato,  Goran Banjac
        University of Oxford  -  Stanford University 2018
-----------------------------------------------------------------
problem:  variables n = 600, constraints m = 10000
          nnz(P) + nnz(A) = 56208
settings: linear system solver = suitesparse ldl,
          eps_abs = 1.0e-03, eps_rel = 1.0e-03,
          eps_prim_inf = 1.0e-04, eps_dual_inf = 1.0e-04,
          rho = 1.00e-01 (adaptive),
          sigma = 1.00e-06, alpha = 1.60, max_iter = 4000
          check_termination: on (interval 25),
          scaling: on, scaled_termination: off
          warm start: on, polish: on

iter   objective    pri res    dua res    rho        time
   1   0.0000e+00   3.50e+01   3.50e+03   1.00e-01   7.42e-02s
 200   1.9436e+02   2.73e+00   1.22e+00   1.00e-01   2.06e-01s
 400   1.9995e+02   1.55e+00   6.86e-01   1.00e-01   3.47e-01s
 600   2.0194e+02   1.21e+00   2.50e-01   1.00e-01   4.78e-01s
 800   2.0282e+02   1.07e+00   2.04e-01   1.00e-01   6.08e-01s
1000   2.0342e+02   9.34e-01   1.14e-01   1.00e-01   7.31e-01s
1200   2.0377e+02   8.07e-01   1.38e-01   1.00e-01   8.63e-01s
1400   2.0438e+02   7.76e-01   1.03e-01   1.00e-01   9.92e-01s
1600   2.0474e+02   7.83e-01   6.50e-02   1.00e-01   1.12e+00s
1800   2.0513e+02   7.65e-01   5.92e-02   1.00e-01   1.25e+00s
2000   2.0532e+02   7.41e-01   5.39e-02   1.00e-01   1.38e+00s
2200   2.0549e+02   7.22e-01   1.12e-01   1.00e-01   1.51e+00s
2400   2.0563e+02   6.96e-01   4.49e-02   1.00e-01   1.64e+00s
2600   2.0575e+02   6.74e-01   4.10e-02   1.00e-01   1.77e+00s
2800   2.0585e+02   6.53e-01   3.73e-02   1.00e-01   1.91e+00s
3000   2.0600e+02   6.36e-01   3.40e-02   1.00e-01   2.04e+00s
3200   2.0619e+02   6.29e-01   3.10e-02   1.00e-01   2.17e+00s
3400   2.0628e+02   6.19e-01   2.83e-02   1.00e-01   2.30e+00s
3600   2.0634e+02   6.09e-01   2.58e-02   1.00e-01   2.43e+00s
3800   2.0639e+02   5.99e-01   2.34e-02   1.00e-01   2.57e+00s
4000   2.0643e+02   5.90e-01   2.13e-02   1.00e-01   2.69e+00s

status:               solved inaccurate
number of iterations: 4000
optimal objective:    206.4307
run time:             2.69e+00s
optimal rho estimate: 1.06e-01

Testing on test-set...
pred                      real
17.57878586435702         18.0
13.936046267015275        15.0
15.18090599540766         18.0
17.330712346983038        16.0
17.621777379504454        17.0
24.984659177285607        15.0
37.14348727283969         14.0
31.254247190047735        14.0
34.262662860450234        14.0
24.249979350114607        15.0
34.167680143685516        15.0
14.310637921955706        14.0
37.03605071446573         15.0
124.55469261244835        14.0
21.661410917679657        24.0
21.092223552701864        22.0
21.041212351214728        18.0
23.450406011852902        21.0
25.294281912925864        27.0
28.30367772574251         26.0
21.121644775312035        25.0
21.745598296610236        24.0
22.344647163455093        25.0
35.79237497049039         26.0
22.559947474677443        21.0
10.813459163267794        10.0
Test batch size:  26
Test mse:  564.3047231264828

Prob solve time:  2.694607
